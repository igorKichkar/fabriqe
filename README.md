<h1 align="center">Сервис уведомлений</h1>

- Для пользователя системы доступны методы создания новой рассылки, просмотра созданных и получения статистики по выполненным рассылкам. Также реализован сам сервис отправки уведомлений на внешнее API.

- После создания новой рассылки, если текущее время больше времени начала и меньше времени окончания - выбираются из справочника все клиенты, которые подходят под значения фильтра, указанного в этой рассылке и запущена отправка для всех этих клиентов.

- По ходу отправки сообщений собирается статистика по каждому сообщению для последующего формирования отчётов.

- Внешний сервис, который принимает отправляемые сообщения, может долго обрабатывать запрос, отвечать некорректными данными, на какое-то время вообще не принимать запросы. Реализована обработку подобных ошибок. Проблемы с внешним сервисом не влияют на стабильность работы сервиса рассылок.

- Реализован дополнительный сервис, который раз в сутки отправляет статистику по обработанным рассылкам на email

- По адресу /docs/ доступна страница со Swagger UI и в нём отображается описание разработанного API.

### При создании проекта использовался следующий стек технологий:
- Django framework.
- Django REST framework.
- Sqlite database.
- Celery.
- Redis.
- Swagger.

### Для запуска проекта нужно:
- Запустить Redis в Docker.
```
sudo docker run -d -p 6379:6379 redis
```
- Клонировать репозиторий "fabriqe".
- создать виртуальное окружение в папке с проектом:
```
python3 -m venv .venv
```
- Активировать виртуальное акружение:
```
source .venv/bin/activate
```
- Установить зависимости:
```
pip install -r requirements.txt
```
- Запустить сервер:
```
./manage.py runserver
```
- В другом окне терминала запустить celery worker:
```
celery -A mailing_list worker -l info
```
- В еще одном окне терминала запустить celery beat:
```
celery -A mailing_list beat -l info
```
### API для работы с сервисом:
- Получение общей статистики по созданным рассылкам и количеству отправленных сообщений по ним с группировкой по статусам:
```
(GET)/mailings/general_statistics/
```
- Получение детальной статистики отправленных сообщений по конкретной рассылке:
```
(GET)/mailings/{id}/detail_statistics/
```
- Добавление новой рассылки со всеми её атрибутами:
```
(POST)/mailings/
```
- Обновление атрибутов рассылки:
```
(PUT)/mailings/{id}/
```
- Обновление атрибутов рассылки:
```
(PATCH)/mailings/{id}/
```
- Удаление рассылки:
```
(DELETE)/mailings/{id}/
```
- Добавление нового клиента в справочник со всеми его атрибутами:
```
(GET)/clients/
```
- Обновление данных атрибутов клиента:
```
(PUT)/clients/{id}/
```
- Обновление данных атрибутов клиента:
```
(PATCH)/clients/{id}/
```
- Удаление клиента:
```
(DELETE)/clients/{id}/
```

